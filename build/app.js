!function(t){var e={};function s(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=t,s.c=e,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},s.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=2)}([function(t,e){t.exports=class{constructor(t){this.mpp=t,this.threshold=1e3,this.worker=new Worker("./WorkerTimer.js"),this.worker.onmessage=(t=>{t.data.args&&(0==t.data.args.action?this.actualPlay(t.data.args.id,t.data.args.vol,t.data.args.time,t.data.args.part_id):this.actualStop(t.data.args.id,t.data.args.time,t.data.args.part_id))})}init(t){return this.volume=.6,this.sounds={},this.context=new AudioContext,this.masterGain=this.context.createGain(),this.masterGain.connect(this.context.destination),this.masterGain.gain.value=this.volume,this.limiterNode=this.context.createDynamicsCompressor(),this.limiterNode.threshold.value=-10,this.limiterNode.knee.value=0,this.limiterNode.ratio.value=20,this.limiterNode.attack.value=0,this.limiterNode.release.value=.1,this.limiterNode.connect(this.masterGain),this.pianoGain=this.context.createGain(),this.pianoGain.gain.value=.5,this.pianoGain.connect(this.limiterNode),this.synthGain=this.context.createGain(),this.synthGain.gain.value=.5,this.synthGain.connect(this.limiterNode),this.playings={},t&&setTimeout(t,0),this}load(t,e,s){const i=new XMLHttpRequest;i.open("GET",e),i.responseType="arraybuffer",i.addEventListener("readystatechange",()=>{if(4===i.readyState)try{this.context.decodeAudioData(i.response,e=>{if(this.sounds[t]=e,s)return s()})}catch(s){throw new Error(`${s.message} / `+`id: ${t} / `+`url: ${e} / `+`status: ${i.status} / `+`ArrayBuffer: ${i.response instanceof ArrayBuffer} / `+`byteLength: ${i.response&&i.response.byteLength?i.response.byteLength:"undefined"}`)}}),i.send()}actualPlay(t,e,s,i){if(!this.sounds.hasOwnProperty(t))return;const a=this.context.createBufferSource();a.buffer=this.sounds[t];const n=this.context.createGain();if(n.gain.value=e,a.connect(n),n.connect(this.pianoGain),a.start(s),this.playings[t]){const e=this.playings[t];e.gain.gain.setValueAtTime(e.gain.gain.value,s),e.gain.gain.linearRampToValueAtTime(0,s+.2),e.source.stop(s+.21)}this.playings[t]={source:a,gain:n,part_id:i}}actualStop(t,e,s){if(!this.playings.hasOwnProperty(t)||!this.playings[t]||this.playings[t].part_id!==s)return;const i=this.playings[t].gain.gain;i.setValueAtTime(i.value,e),i.linearRampToValueAtTime(.1*i.value,e+.16),i.linearRampToValueAtTime(0,e+.4),this.playings[t].source.stop(e+.41),this.playings[t].voice&&this.playings[t].voice.stop(e),this.playings[t]=null}play(t,e,s,i){if(!this.sounds.hasOwnProperty(t))return;const a=this.context.currentTime+s/1e3,n=s-this.threshold;n<=0?this.actualPlay(t,e,a,i):this.worker.postMessage({delay:n,args:{action:0,id:t,vol:e,time:a,part_id:i}})}stop(t,e,s){const i=this.context.currentTime+e/1e3,a=e-this.threshold;a<=0?this.actualStop(t,i,s):this.worker.postMessage({delay:a,args:{action:1,id:t,time:i,part_id:s}})}setVolume(t){this.volume=t,this.masterGain.gain.value=this.volume}}},function(t,e,s){const i=s(0);t.exports=class{constructor(){this.testMode=!1,this.seeOwnCursor=!1,this.sounds={path:"./audio/default/",ext:".wav.mp3"},this.defaults={DEFAULT_VELOCITY:.5,TIMING_TARGET:1e3},this.handleURLHashes(),this.audio=new i(this)}handleURLHashes(){this.hashes=window.location.hash.toLowerCase().split("#"),this.hashes.shift(),this.testMode=this.hashes.includes("test"),this.seeOwnCursor=this.hashes.includes("seeowncursor")}}},function(t,e,s){s(7);const i=s(1);window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||(t=>{setTimeout(t,1e3/30)}),window.MPP=new i},,,,,function(t,e){}]);